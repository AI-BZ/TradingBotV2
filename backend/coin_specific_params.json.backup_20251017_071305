{
  "version": "5.0",
  "description": "Coin-specific parameters for Two-Way Simultaneous Entry Strategy - VOLUME FILTER + DYNAMIC HARD STOP",
  "last_updated": "2025-10-16 (Added volume filter and ATR-based dynamic hard stops)",

  "volatility_tiers": {
    "tier_1_low": {
      "description": "Large cap, established cryptocurrencies (BTC, ETH, BNB)",
      "typical_volatility": "40-60% annualized",
      "entry_target": "35-50 signals per month"
    },
    "tier_2_medium": {
      "description": "Mid cap altcoins (SOL, XRP, SUI)",
      "typical_volatility": "60-100% annualized",
      "entry_target": "40-60 signals per month"
    },
    "tier_3_high": {
      "description": "High volatility coins (DOGE, meme coins, small caps)",
      "typical_volatility": "100%+ annualized",
      "entry_target": "45-70 signals per month"
    }
  },

  "coin_parameters": {
    "BTC/USDT": {
      "tier": "tier_1_low",
      "bb_compression": 0.0350,
      "atr_expansion": 0.0070,
      "hard_stop": 0.015,
      "trailing_multiplier": 2.0,
      "min_volume_ratio": 2.0,
      "expected_entries_per_day": 1.2,
      "rationale": "v3.0: Relaxed ATR 0.39%→0.70% for more signals, increased volume filter 1.5x→2.0x, widened stop 1.2%→1.5%"
    },
    "ETH/USDT": {
      "tier": "tier_1_low",
      "bb_compression": 0.0600,
      "atr_expansion": 0.0100,
      "hard_stop": 0.015,
      "trailing_multiplier": 2.0,
      "min_volume_ratio": 2.0,
      "expected_entries_per_day": 1.3,
      "rationale": "v3.0: Relaxed ATR 0.68%→1.00% for more signals, increased volume filter 1.5x→2.0x, widened stop 1.2%→1.5%"
    },
    "SOL/USDT": {
      "tier": "tier_2_medium",
      "bb_compression": 0.0750,
      "atr_expansion": 0.0130,
      "hard_stop": 0.018,
      "trailing_multiplier": 2.2,
      "min_volume_ratio": 2.2,
      "expected_entries_per_day": 1.5,
      "rationale": "v3.0: Relaxed ATR 0.91%→1.30% for more signals, increased volume filter 1.8x→2.2x, widened stop 1.5%→1.8%"
    },
    "BNB/USDT": {
      "tier": "tier_1_low",
      "bb_compression": 0.0750,
      "atr_expansion": 0.0110,
      "hard_stop": 0.016,
      "trailing_multiplier": 2.0,
      "min_volume_ratio": 2.0,
      "expected_entries_per_day": 1.2,
      "rationale": "v3.0: Relaxed ATR 0.78%→1.10% for more signals, increased volume filter 1.6x→2.0x, widened stop 1.3%→1.6%"
    },
    "DOGE/USDT": {
      "tier": "tier_3_high",
      "bb_compression": 0.0800,
      "atr_expansion": 0.0140,
      "hard_stop": 0.025,
      "trailing_multiplier": 2.5,
      "min_volume_ratio": 2.5,
      "expected_entries_per_day": 2.0,
      "rationale": "v3.0: Relaxed ATR 0.99%→1.40% for more signals, increased volume filter 2.0x→2.5x, widened stop 2.0%→2.5%"
    },
    "XRP/USDT": {
      "tier": "tier_2_medium",
      "bb_compression": 0.0600,
      "atr_expansion": 0.0100,
      "hard_stop": 0.017,
      "trailing_multiplier": 2.1,
      "min_volume_ratio": 2.1,
      "expected_entries_per_day": 1.4,
      "rationale": "v3.0: Relaxed ATR 0.66%→1.00% for more signals, increased volume filter 1.7x→2.1x, widened stop 1.4%→1.7%"
    },
    "XPL/USDT": {
      "tier": "tier_3_high",
      "bb_compression": 0.1600,
      "atr_expansion": 0.0400,
      "hard_stop": 0.028,
      "trailing_multiplier": 2.8,
      "min_volume_ratio": 2.8,
      "expected_entries_per_day": 1.8,
      "rationale": "v3.0: CRITICAL FIX - Tightened BB 21.91%→16.00% to reduce false signals, relaxed ATR 3.26%→4.00%, widened stop 1.8%→2.8%, stronger volume filter 2.0x→2.8x"
    },
    "SUI/USDT": {
      "tier": "tier_2_medium",
      "bb_compression": 0.0750,
      "atr_expansion": 0.0130,
      "hard_stop": 0.019,
      "trailing_multiplier": 2.3,
      "min_volume_ratio": 2.3,
      "expected_entries_per_day": 1.6,
      "rationale": "v3.0: Relaxed ATR 0.91%→1.30% for more signals, increased volume filter 1.9x→2.3x, widened stop 1.6%→1.9%"
    },
    "1000PEPE/USDT": {
      "tier": "tier_3_high",
      "bb_compression": 0.0750,
      "atr_expansion": 0.0150,
      "hard_stop": 0.027,
      "trailing_multiplier": 2.6,
      "min_volume_ratio": 2.6,
      "expected_entries_per_day": 2.2,
      "rationale": "v3.0: Relaxed ATR 1.01%→1.50% for more signals, increased volume filter 2.2x→2.6x, widened stop 2.2%→2.7%"
    },
    "HYPE/USDT": {
      "tier": "tier_3_high",
      "bb_compression": 0.1000,
      "atr_expansion": 0.0180,
      "hard_stop": 0.024,
      "trailing_multiplier": 2.5,
      "min_volume_ratio": 2.5,
      "expected_entries_per_day": 1.9,
      "rationale": "v3.0: Relaxed ATR 1.38%→1.80% for more signals, increased volume filter 2.1x→2.5x, widened stop 1.9%→2.4%"
    }
  },

  "fallback_parameters": {
    "bb_compression": 0.055,
    "atr_expansion": 0.010,
    "hard_stop": 0.015,
    "trailing_multiplier": 2.0,
    "min_volume_ratio": 1.8,
    "rationale": "Default parameters based on diagnostic averages"
  },

  "parameter_constraints": {
    "bb_compression": {
      "min": 0.02,
      "max": 0.25,
      "description": "Bollinger Bands bandwidth threshold (2-25%)"
    },
    "atr_expansion": {
      "min": 0.003,
      "max": 0.05,
      "description": "ATR as percentage of price (0.3-5%)"
    },
    "hard_stop": {
      "min": 0.005,
      "max": 0.03,
      "description": "Hard stop loss percentage (0.5-3%)"
    },
    "trailing_multiplier": {
      "min": 1.2,
      "max": 3.0,
      "description": "ATR multiplier for trailing stop (1.2x-3.0x)"
    },
    "min_volume_ratio": {
      "min": 1.0,
      "max": 3.0,
      "description": "Current volume vs average volume ratio"
    }
  },

  "diagnostic_notes": {
    "v2.0_findings": "ATR thresholds were 3-5x too high, causing 0% signal generation",
    "v2.0_result": "Fixed signal generation (0→96 trades), but XPL dominated (81% of trades), strategy unprofitable (-4.94%)",
    "v3.0_improvements": [
      "CRITICAL: Tightened XPL BB threshold 21.91%→16.00% to reduce excessive false signals (was 78/96 trades)",
      "Relaxed all other coins' ATR thresholds (BTC 0.39%→0.70%, ETH 0.68%→1.00%, SOL 0.91%→1.30%, etc.)",
      "Strengthened volume confirmation across all coins (1.5-2.0x → 2.0-2.8x)",
      "Widened hard stops to reduce premature exits (BTC 1.2%→1.5%, XPL 1.8%→2.8%, etc.)",
      "Increased trailing multipliers for better profit capture (BTC 1.8→2.0, XPL 2.1→2.8)"
    ],
    "v3.0_result": "Partial success: XPL reduced (78% → 78% of 54 trades), but 5 coins still generate 0 signals (BTC/ETH/SOL/BNB/PEPE)",
    "v3.0_root_cause": "Signal strength calculation used hardcoded 3% ATR threshold, causing low-ATR coins (BTC 0.54%, ETH 0.97%) to get <50% confidence and be filtered out",
    "v4.0_fix": [
      "CRITICAL: Signal strength calculation now uses coin-specific thresholds (trading_strategy.py:196-197)",
      "expansion_strength: Changed from 'atr_pct / 0.03' to 'atr_pct / atr_threshold'",
      "compression_strength: Changed from '(0.05 - bb_bandwidth) / 0.05' to '(bb_threshold - bb_bandwidth) / bb_threshold'",
      "Expected impact: BTC expansion_strength 0.54%/0.70% = 0.77 (vs 0.18), combined strength 0.89 (vs 0.49)",
      "No parameter changes needed - v3.0 thresholds are correct, just strength calculation was broken"
    ],
    "v4.0_result": "SUCCESS: 280 trades (+418%), +3.16% return (profitable!), all 10 coins active, XPL 15% (balanced), 30.36% win rate, 1.09 profit factor",
    "v4.0_issue": "Multi-timeframe backtest shows overfitting: 1m +3.16%, 3m -5.3% (60% complete) → parameters optimized for recent data",
    "v5.0_improvements": [
      "VOLUME FILTER (trading_strategy.py:170-182): Filters false breakouts, requires volume_ratio >= min_volume_ratio (1.5-2.8x)",
      "DYNAMIC HARD STOP (trailing_stop_manager.py:15-44, 153-171): ATR-based stops adapt to volatility",
      "  - High volatility: Wider stops (prevents premature exits like XPL -6.41%, -7.74%)",
      "  - Low volatility: Tighter stops (better risk management)",
      "  - Formula: max(1%, ATR% × 2.0) vs fixed 1%",
      "Expected impact: +5% win rate (30%→35%), reduced false signals, better drawdown control"
    ],
    "validation_required": "30-day backtest to verify: (1) Win rate >35%, (2) Fewer false breakouts, (3) Better drawdown management, (4) Multi-timeframe stability"
  },

  "optimization_notes": {
    "entry_frequency_target": "1-2 entries per day per coin (30-60 entries over 30 days)",
    "overfitting_prevention": [
      "Parameters based on actual market volatility data, not curve-fitted",
      "Used 25th-75th percentiles from 30-day historical analysis",
      "Volume confirmation to filter false breakouts",
      "Multi-timeframe validation required"
    ],
    "validation_strategy": [
      "1 month backtest (40% weight) - Recent market adaptation",
      "3 months backtest (30% weight) - Quarterly stability",
      "6 months backtest (20% weight) - Extended robustness",
      "1 year backtest (10% weight) - Full cycle validation"
    ]
  }
}
